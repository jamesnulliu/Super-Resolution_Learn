<!DOCTYPE html><html><head>
      <title>Speech</title>
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css">
      
      
      
      
      
      <style>
      code[class*=language-],pre[class*=language-]{color:#333;background:0 0;font-family:Consolas,"Liberation Mono",Menlo,Courier,monospace;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;word-wrap:normal;line-height:1.4;-moz-tab-size:8;-o-tab-size:8;tab-size:8;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none}pre[class*=language-]{padding:.8em;overflow:auto;border-radius:3px;background:#f5f5f5}:not(pre)>code[class*=language-]{padding:.1em;border-radius:.3em;white-space:normal;background:#f5f5f5}.token.blockquote,.token.comment{color:#969896}.token.cdata{color:#183691}.token.doctype,.token.macro.property,.token.punctuation,.token.variable{color:#333}.token.builtin,.token.important,.token.keyword,.token.operator,.token.rule{color:#a71d5d}.token.attr-value,.token.regex,.token.string,.token.url{color:#183691}.token.atrule,.token.boolean,.token.code,.token.command,.token.constant,.token.entity,.token.number,.token.property,.token.symbol{color:#0086b3}.token.prolog,.token.selector,.token.tag{color:#63a35c}.token.attr-name,.token.class,.token.class-name,.token.function,.token.id,.token.namespace,.token.pseudo-class,.token.pseudo-element,.token.url-reference .token.variable{color:#795da3}.token.entity{cursor:help}.token.title,.token.title .token.punctuation{font-weight:700;color:#1d3e81}.token.list{color:#ed6a43}.token.inserted{background-color:#eaffea;color:#55a532}.token.deleted{background-color:#ffecec;color:#bd2c00}.token.bold{font-weight:700}.token.italic{font-style:italic}.language-json .token.property{color:#183691}.language-markup .token.tag .token.punctuation{color:#333}.language-css .token.function,code.language-css{color:#0086b3}.language-yaml .token.atrule{color:#63a35c}code.language-yaml{color:#183691}.language-ruby .token.function{color:#333}.language-markdown .token.url{color:#795da3}.language-makefile .token.symbol{color:#795da3}.language-makefile .token.variable{color:#183691}.language-makefile .token.builtin{color:#0086b3}.language-bash .token.keyword{color:#0086b3}pre[data-line]{position:relative;padding:1em 0 1em 3em}pre[data-line] .line-highlight-wrapper{position:absolute;top:0;left:0;background-color:transparent;display:block;width:100%}pre[data-line] .line-highlight{position:absolute;left:0;right:0;padding:inherit 0;margin-top:1em;background:hsla(24,20%,50%,.08);background:linear-gradient(to right,hsla(24,20%,50%,.1) 70%,hsla(24,20%,50%,0));pointer-events:none;line-height:inherit;white-space:pre}pre[data-line] .line-highlight:before,pre[data-line] .line-highlight[data-end]:after{content:attr(data-start);position:absolute;top:.4em;left:.6em;min-width:1em;padding:0 .5em;background-color:hsla(24,20%,50%,.4);color:#f4f1ef;font:bold 65%/1.5 sans-serif;text-align:center;vertical-align:.3em;border-radius:999px;text-shadow:none;box-shadow:0 1px #fff}pre[data-line] .line-highlight[data-end]:after{content:attr(data-end);top:auto;bottom:.4em}html body{font-family:"Helvetica Neue",Helvetica,"Segoe UI",Arial,freesans,sans-serif;font-size:16px;line-height:1.6;color:#333;background-color:#fff;overflow:initial;box-sizing:border-box;word-wrap:break-word}html body>:first-child{margin-top:0}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{line-height:1.2;margin-top:1em;margin-bottom:16px;color:#000}html body h1{font-size:2.25em;font-weight:300;padding-bottom:.3em}html body h2{font-size:1.75em;font-weight:400;padding-bottom:.3em}html body h3{font-size:1.5em;font-weight:500}html body h4{font-size:1.25em;font-weight:600}html body h5{font-size:1.1em;font-weight:600}html body h6{font-size:1em;font-weight:600}html body h1,html body h2,html body h3,html body h4,html body h5{font-weight:600}html body h5{font-size:1em}html body h6{color:#5c5c5c}html body strong{color:#000}html body del{color:#5c5c5c}html body a:not([href]){color:inherit;text-decoration:none}html body a{color:#08c;text-decoration:none}html body a:hover{color:#00a3f5;text-decoration:none}html body img{max-width:100%}html body>p{margin-top:0;margin-bottom:16px;word-wrap:break-word}html body>ol,html body>ul{margin-bottom:16px}html body ol,html body ul{padding-left:2em}html body ol.no-list,html body ul.no-list{padding:0;list-style-type:none}html body ol ol,html body ol ul,html body ul ol,html body ul ul{margin-top:0;margin-bottom:0}html body li{margin-bottom:0}html body li.task-list-item{list-style:none}html body li>p{margin-top:0;margin-bottom:0}html body .task-list-item-checkbox{margin:0 .2em .25em -1.8em;vertical-align:middle}html body .task-list-item-checkbox:hover{cursor:pointer}html body blockquote{margin:16px 0;font-size:inherit;padding:0 15px;color:#5c5c5c;background-color:#f0f0f0;border-left:4px solid #d6d6d6}html body blockquote>:first-child{margin-top:0}html body blockquote>:last-child{margin-bottom:0}html body hr{height:4px;margin:32px 0;background-color:#d6d6d6;border:0 none}html body table{margin:10px 0 15px 0;border-collapse:collapse;border-spacing:0;display:block;width:100%;overflow:auto;word-break:normal;word-break:keep-all}html body table th{font-weight:700;color:#000}html body table td,html body table th{border:1px solid #d6d6d6;padding:6px 13px}html body dl{padding:0}html body dl dt{padding:0;margin-top:16px;font-size:1em;font-style:italic;font-weight:700}html body dl dd{padding:0 16px;margin-bottom:16px}html body code{font-family:Menlo,Monaco,Consolas,'Courier New',monospace;font-size:.85em!important;color:#000;background-color:#f0f0f0;border-radius:3px;padding:.2em 0}html body code::after,html body code::before{letter-spacing:-.2em;content:"\00a0"}html body pre>code{padding:0;margin:0;font-size:.85em!important;word-break:normal;white-space:pre;background:0 0;border:0}html body .highlight{margin-bottom:16px}html body .highlight pre,html body pre{padding:1em;overflow:auto;font-size:.85em!important;line-height:1.45;border:#d6d6d6;border-radius:3px}html body .highlight pre{margin-bottom:0;word-break:normal}html body pre code,html body pre tt{display:inline;max-width:initial;padding:0;margin:0;overflow:initial;line-height:inherit;word-wrap:normal;background-color:transparent;border:0}html body pre code:after,html body pre code:before,html body pre tt:after,html body pre tt:before{content:normal}html body blockquote,html body dl,html body ol,html body p,html body pre,html body ul{margin-top:0;margin-bottom:16px}html body kbd{color:#000;border:1px solid #d6d6d6;border-bottom:2px solid #c7c7c7;padding:2px 4px;background-color:#f0f0f0;border-radius:3px}@media print{html body{background-color:#fff}html body h1,html body h2,html body h3,html body h4,html body h5,html body h6{color:#000;page-break-after:avoid}html body blockquote{color:#5c5c5c}html body pre{page-break-inside:avoid}html body table{display:table}html body img{display:block;max-width:100%;max-height:100%}html body code,html body pre{word-wrap:break-word;white-space:pre}}.markdown-preview{width:100%;height:100%;box-sizing:border-box}.markdown-preview .newpage,.markdown-preview .pagebreak{page-break-before:always}.markdown-preview pre.line-numbers{position:relative;padding-left:3.8em;counter-reset:linenumber}.markdown-preview pre.line-numbers>code{position:relative}.markdown-preview pre.line-numbers .line-numbers-rows{position:absolute;pointer-events:none;top:1em;font-size:100%;left:0;width:3em;letter-spacing:-1px;border-right:1px solid #999;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.markdown-preview pre.line-numbers .line-numbers-rows>span{pointer-events:none;display:block;counter-increment:linenumber}.markdown-preview pre.line-numbers .line-numbers-rows>span:before{content:counter(linenumber);color:#999;display:block;padding-right:.8em;text-align:right}.markdown-preview .mathjax-exps .MathJax_Display{text-align:center!important}.markdown-preview:not([data-for=preview]) .code-chunk .btn-group{display:none}.markdown-preview:not([data-for=preview]) .code-chunk .status{display:none}.markdown-preview:not([data-for=preview]) .code-chunk .output-div{margin-bottom:16px}.markdown-preview .md-toc{padding:0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link div,.markdown-preview .md-toc .md-toc-link-wrapper .md-toc-link p{display:inline}.markdown-preview .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}.scrollbar-style::-webkit-scrollbar{width:8px}.scrollbar-style::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}.scrollbar-style::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode]){position:relative;width:100%;height:100%;top:0;left:0;margin:0;padding:0;overflow:auto}html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{position:relative;top:0;min-height:100vh}@media screen and (min-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em calc(50% - 457px + 2em)}}@media screen and (max-width:914px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for=html-export]:not([data-presentation-mode]) .markdown-preview{font-size:14px!important;padding:1em}}@media print{html body[for=html-export]:not([data-presentation-mode]) #sidebar-toc-btn{display:none}}html body[for=html-export]:not([data-presentation-mode]) #sidebar-toc-btn{position:fixed;bottom:8px;left:8px;font-size:28px;cursor:pointer;color:inherit;z-index:99;width:32px;text-align:center;opacity:.4}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] #sidebar-toc-btn{opacity:1}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc{position:fixed;top:0;left:0;width:300px;height:100%;padding:32px 0 48px 0;font-size:14px;box-shadow:0 0 4px rgba(150,150,150,.33);box-sizing:border-box;overflow:auto;background-color:inherit}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar{width:8px}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-track{border-radius:10px;background-color:transparent}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc::-webkit-scrollbar-thumb{border-radius:5px;background-color:rgba(150,150,150,.66);border:4px solid rgba(150,150,150,.66);background-clip:content-box}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc a{text-decoration:none}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc{padding:0 16px}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link{display:inline;padding:.25rem 0}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link div,html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper .md-toc-link p{display:inline}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .md-sidebar-toc .md-toc .md-toc-link-wrapper.highlighted .md-toc-link{font-weight:800}html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{left:300px;width:calc(100% - 300px);padding:2em calc(50% - 457px - 300px/2);margin:0;box-sizing:border-box}@media screen and (max-width:1274px){html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{padding:2em}}@media screen and (max-width:450px){html body[for=html-export]:not([data-presentation-mode])[html-show-sidebar-toc] .markdown-preview{width:100%}}html body[for=html-export]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .markdown-preview{left:50%;transform:translateX(-50%)}html body[for=html-export]:not([data-presentation-mode]):not([html-show-sidebar-toc]) .md-sidebar-toc{display:none}
.markdown-preview.markdown-preview {
  background-color: #FCFCFC;
  font-size: 18px;
  font-family: "Times New Roman";
}
.markdown-preview.markdown-preview h1 {
  font-family: "Microsoft YaHei Regular";
  font-size: 26px;
}
.markdown-preview.markdown-preview h2 {
  font-family: "Microsoft YaHei Regular";
  font-size: 21px;
}
.markdown-preview.markdown-preview h3 {
  font-family: "Microsoft YaHei Regular";
  font-size: 19px;
}
.markdown-preview.markdown-preview hr {
  height: 0.01em;
}
@media print {
  .markdown-preview.markdown-preview {
    font-size: 13px;
  }
}
.center {
  text-align: center;
  width: auto;
  display: table;
  margin-left: auto;
  margin-right: auto;
}
.center p,
.center img {
  display: inline-block;
}

      </style>
    </head>
    <body for="html-export">
      <div class="crossnote markdown-preview  ">
      <h1 class="crossnote-header" id="sr-%E5%8F%91%E5%B1%95%E5%8F%B2-review-%E6%B1%87%E6%8A%A5">SR 发展史 Review 汇报</h1>

<h2 class="crossnote-header" id="1-%E5%9F%BA%E4%BA%8E-alexnet-%E7%9A%84-sr-%E6%A8%A1%E5%9E%8B">1. 基于 AlexNet 的 SR 模型</h2>

<h3 class="crossnote-header" id="11-image-super-resolution-using-deep-convolutional-networks-srcnn-2015">1.1. Image super-resolution using deep convolutional networks (SRCNN, 2015)</h3>

<p align="center">
  <img src="imgs/SRCNN_1.png" width="80%"><br>
</p>
<ul>
<li>利用卷积实现 SR</li>
</ul>
<div class="center">
<table>
<thead>
<tr>
<th style="text-align:center">Implementation</th>
<th style="text-align:center">Framework</th>
<th style="text-align:center">Understandable</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><a href="https://github.com/yjn870/SRCNN-pytorch/blob/master/models.py">SRCNN-pytorch</a></td>
<td style="text-align:center">Pytorch</td>
<td style="text-align:center">✅</td>
</tr>
</tbody>
</table>
</div>
<h2 class="crossnote-header" id="2-%E5%9F%BA%E4%BA%8E-vgg-%E7%9A%84-sr-%E6%A8%A1%E5%9E%8B">2. 基于 VGG 的 SR 模型</h2>

<h3 class="crossnote-header" id="21-vgg-%E7%AE%80%E4%BB%8B">2.1. VGG 简介</h3>

<p align="center">
  <img src="imgs/VGG_1.png" width="80%"><br>
</p>
<ul>
<li>更小的卷积核和更深的网络</li>
</ul>
<h3 class="crossnote-header" id="22-accelerating-the-super-resolution-convolutional-neural-network-fsrcnn-2016">2.2. Accelerating the super-resolution convolutional neural network (FSRCNN, 2016)</h3>

<p align="center">
  <img src="imgs/FSRCNN_1.png"><br>
  Conv(<i>f</i>, <i>n</i>, <i>c</i>): kernel size, kernel number (output channel), kernel channel
</p>
<ul>
<li>更小的计算代价和更好的结果</li>
<li>替换 SRCNN 中的 Non-Linear Mapping</li>
</ul>
<div class="center">
<table>
<thead>
<tr>
<th style="text-align:center">Implementation</th>
<th style="text-align:center">Framework</th>
<th style="text-align:center">Understandable</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><a href="https://github.com/yjn870/FSRCNN-pytorch/blob/master/models.py">FSRCNN-pytorch</a></td>
<td style="text-align:center">Pytorch</td>
<td style="text-align:center">✅</td>
</tr>
</tbody>
</table>
</div>
<h2 class="crossnote-header" id="3-%E5%9F%BA%E4%BA%8E-resnet-%E7%9A%84-sr-%E6%A8%A1%E5%9E%8B">3. 基于 ResNet 的 SR 模型</h2>

<h3 class="crossnote-header" id="31-restnet-%E7%AE%80%E4%BB%8B">3.1. RestNet 简介</h3>

<p align="center">
  <img src="imgs/ResBlock_1.png" width="50%"><br>
</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>F</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>H</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>−</mo><mi>x</mi></mrow><annotation encoding="application/x-tex">F(x) = H(x) - x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">x</span></span></span></span></span></p>
<h3 class="crossnote-header" id="32-accurate-image-super-resolution-using-very-deep-convolutional-networks-vdsr-2016">3.2. Accurate Image Super-Resolution Using Very Deep Convolutional Networks (VDSR, 2016)</h3>

<p align="center">
  <img src="imgs/VDSR_1.png" width="80%"><br>
</p>
<ul>
<li>CNN + ResNet</li>
</ul>
<h3 class="crossnote-header" id="33-deeply-recursive-convolutional-network-for-image-super-resolution-drcn-2016">3.3. Deeply-Recursive Convolutional Network for Image Super-Resolution (DRCN, 2016)</h3>

<p align="center">
  <img src="imgs/DRCN_1.png" width="80%"><br>
  <img src="imgs/DRCN_2.png" width="80%">
</p>
<ul>
<li>对比发现模型 (a) 效果最好</li>
<li>(a) 中每次递归的输出和最初的输入会被一同放入识别网络, 形成 ResNet 结构</li>
</ul>
<div class="center">
<table>
<thead>
<tr>
<th style="text-align:center">Implementation</th>
<th style="text-align:center">Framework</th>
<th style="text-align:center">Understandable</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><a href="https://github.com/jiny2001/deeply-recursive-cnn-tf/blob/master/super_resolution.py">super_resolutiondeeply-recursive-cnn-tf</a></td>
<td style="text-align:center">TensorFlow</td>
<td style="text-align:center">❎</td>
</tr>
</tbody>
</table>
</div>
<h3 class="crossnote-header" id="34-photo-realistic-single-image-super-resolution-using-a-generative-adversarial-network-srresnet-2017">3.4. Photo-Realistic Single Image Super-Resolution Using a Generative Adversarial Network (SRResNet, 2017)</h3>

<p align="center">
  <img src="imgs/SRGAN_1.png" width="80%"><br>
</p>
<ul>
<li>GAN + ResNet</li>
</ul>
<div class="center">
<table>
<thead>
<tr>
<th style="text-align:center">Implementation</th>
<th style="text-align:center">Framework</th>
<th style="text-align:center">Understandable</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><a href="https://github.com/twtygqyy/pytorch-SRResNet/blob/master/srresnet.py">pytorch-SRResNet</a></td>
<td style="text-align:center">Pytorch</td>
<td style="text-align:center">✅</td>
</tr>
<tr>
<td style="text-align:center"><a href="https://github.com/eriklindernoren/PyTorch-GAN/blob/master/implementations/esrgan/models.py">ESRGAN</a></td>
<td style="text-align:center">Pytorch</td>
<td style="text-align:center">✅</td>
</tr>
</tbody>
</table>
</div>
<h2 class="crossnote-header" id="4-%E5%9F%BA%E4%BA%8E-densenet-%E7%9A%84-sr-%E6%A8%A1%E5%9E%8B">4. 基于 DenseNet 的 SR 模型</h2>

<p>Densnet 的稠密连接方式可以使得每一层都可以利用之前学习到的所有特征.</p>
<h3 class="crossnote-header" id="41-residual-dense-network-for-image-super-resolution-rdn-2018">4.1. Residual Dense Network for Image Super-Resolution (RDN, 2018)</h3>

<p align="center">
  <img src="imgs/RDN_1.png" width="80%"><br>
  <img src="imgs/RDN_2.png" width="60%">
</p>
<ul>
<li>ResNet 做的是 "add", 而 DenseNet 做的是 "concat"</li>
<li>每层输入来自前层的输出?</li>
<li>效果相比 ResNet 更好</li>
</ul>
<h2 class="crossnote-header" id="5-%E5%9F%BA%E4%BA%8E-channel-attention-%E5%92%8C-non-local-attention-%E7%9A%84-sr-%E6%A8%A1%E5%9E%8B">5. 基于 Channel Attention 和 Non-Local Attention 的 SR 模型</h2>

<h3 class="crossnote-header" id="51-%E4%BB%80%E4%B9%88%E6%98%AF-channel-attention">5.1. 什么是 Channel Attention</h3>

<p>源自: Squeeze-and-Excitation Networks (SENet, 2017)</p>
<p align="center">
  <img src="imgs/SENet_1.png"><br>
</p>
<ul>
<li>卷积操作 (卷积核) 本身的感受有限</li>
<li>因此希望寻找同一通道的特征</li>
</ul>
<p>Input: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mrow><mo stretchy="false">(</mo><msup><mi>C</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>×</mo><msup><mi>W</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo>×</mo><msup><mi>H</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">X \in \R^{(C' \times W'\times H')}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7224em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.9425em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9425em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8278em;"><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mbin mtight">×</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8278em;"><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mbin mtight">×</span><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.08125em;">H</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8278em;"><span style="top:-2.931em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span> .</p>
<p><strong>Step 1: Transformation</strong><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mrow><mi>t</mi><mi>r</mi></mrow></msub><mo stretchy="false">(</mo><mi>X</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">F_{tr}(X)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight" style="margin-right:0.02778em;">r</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mclose">)</span></span></span></span> is a conv operator maps <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>X</mi></mrow><annotation encoding="application/x-tex">X</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span></span></span> to feature map <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>U</mi><mo>∈</mo><msup><mi mathvariant="double-struck">R</mi><mrow><mo stretchy="false">(</mo><mi>C</mi><mo>×</mo><mi>W</mi><mo>×</mo><mi>R</mi><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">U \in \R^{(C \times W \times R)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7224em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">U</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">∈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.888em;"></span><span class="mord"><span class="mord mathbb">R</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">W</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight" style="margin-right:0.00773em;">R</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span> .</p>
<p><strong>Step 2: Squeeze</strong></p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>z</mi><mi>c</mi></msub><mo>=</mo><msub><mi>F</mi><mrow><mi>s</mi><mi>q</mi></mrow></msub><mo stretchy="false">(</mo><msub><mi>u</mi><mi>c</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mfrac><mn>1</mn><mrow><mi>H</mi><mo>×</mo><mi>W</mi></mrow></mfrac><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>H</mi></munderover><munderover><mo>∑</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mi>W</mi></munderover><msubsup><mi>u</mi><mi>c</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo separator="true">,</mo><mi>j</mi><mo stretchy="false">)</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex">z_c = F_{sq}(u_c) = \frac{1}{H \times W}\sum^{H}_{i=1}\sum^{W}_{j=1}{u_c^{(i,j)}}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.044em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.0361em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">s</span><span class="mord mathnormal mtight" style="margin-right:0.03588em;">q</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.2421em;vertical-align:-1.4138em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.08125em;">H</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.7693em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.08125em;">H</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.8283em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">W</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4138em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<p><strong>Step 3: Excitation</strong><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mrow><mi>e</mi><mi>x</mi></mrow></msub><mo stretchy="false">(</mo><mo>⋅</mo><mo separator="true">,</mo><mi>W</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">F_{ex}(\cdot,W)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord">⋅</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mclose">)</span></span></span></span> is a FC layer, map <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>z</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo>×</mo><mn>1</mn><mo>×</mo><mi>C</mi><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">z^{(1 \times 1 \times C)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.888em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mbin mtight">×</span><span class="mord mtight">1</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span> to <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>u</mi><mrow><mo stretchy="false">(</mo><mn>1</mn><mo>×</mo><mn>1</mn><mo>×</mo><mi>C</mi><mo stretchy="false">)</mo></mrow></msup></mrow><annotation encoding="application/x-tex">u^{(1 \times 1 \times C)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.888em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.888em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mtight">1</span><span class="mbin mtight">×</span><span class="mord mtight">1</span><span class="mbin mtight">×</span><span class="mord mathnormal mtight" style="margin-right:0.07153em;">C</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span></span></span></span>.<br>
And finally:<br>
<span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>F</mi><mrow><mi>s</mi><mi>c</mi></mrow></msub><mo stretchy="false">(</mo><msub><mi>u</mi><mi>c</mi></msub><mo separator="true">,</mo><msub><mi>s</mi><mi>c</mi></msub><mo stretchy="false">)</mo><mo>=</mo><msub><mi>s</mi><mi>c</mi></msub><msub><mi>u</mi><mi>c</mi></msub></mrow><annotation encoding="application/x-tex">F_{sc}(u_c, s_c)=s_cu_c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">sc</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<h3 class="crossnote-header" id="52-image-super-resolution-using-very-deep-residual-channel-attention-networks-rcan-2018">5.2. Image Super-Resolution Using Very Deep Residual Channel Attention Networks (RCAN, 2018)</h3>

<p align="center">
  <img src="imgs/RCAN_1.png" width="80%"><br>
  Archetecture of RCAN
</p>
<p align="center">
  <img src="imgs/RCAN_2.png" width="80%"><br>
  Channel attention (CA)
</p>
<p align="center">
  <img src="imgs/RCAN_3.png" width="80%"><br>
  Residual channel attention block (RCAB)
</p>
<ul>
<li>RIR, 残差网络中用残差网络</li>
<li>多个 skip connection</li>
<li>Channel Attention</li>
</ul>
<div class="center">
<table>
<thead>
<tr>
<th style="text-align:center">Implementation</th>
<th style="text-align:center">Framework</th>
<th style="text-align:center">Understandable</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><a href="https://github.com/yulunzhang/RCAN/blob/master/RCAN_TrainCode/code/model/rcan.py">RCAN</a></td>
<td style="text-align:center">Pytorch</td>
<td style="text-align:center">✅</td>
</tr>
</tbody>
</table>
</div>
<h3 class="crossnote-header" id="53-%E4%BB%80%E4%B9%88%E6%98%AF-non-local-attention">5.3. 什么是 Non-Local Attention</h3>

<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi mathvariant="normal">y</mi><mi>i</mi></msub><mo>=</mo><mfrac><mn>1</mn><mrow><mi mathvariant="script">C</mi><mo stretchy="false">(</mo><mi mathvariant="normal">x</mi><mo stretchy="false">)</mo></mrow></mfrac><munder><mo>∑</mo><mrow><mi mathvariant="normal">∀</mi><mi>j</mi></mrow></munder><mi>f</mi><mo stretchy="false">(</mo><msub><mi mathvariant="normal">x</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi mathvariant="normal">x</mi><mi>j</mi></msub><mo stretchy="false">)</mo><mi>g</mi><mo stretchy="false">(</mo><msub><mi mathvariant="normal">x</mi><mi>j</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\mathrm{y}_i=\frac{1}{\mathcal{C}(\mathrm{x})}\sum_{\forall j}f(\mathrm{x}_i,\mathrm{x}_j)g(\mathrm{x}_j)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathrm" style="margin-right:0.01389em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0139em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.7597em;vertical-align:-1.4382em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.05834em;">C</span><span class="mopen">(</span><span class="mord mathrm">x</span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8479em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">∀</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4382em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord"><span class="mord mathrm">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathrm">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord"><span class="mord mathrm">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p>
<p align="center">
  <img src="imgs/NonLocal_2.png" width="80%"><br>
</p>
<ul>
<li>同样为了解决卷积核视野小的问题</li>
<li>计算复杂度高</li>
</ul>
<p>将 Non-Local 定义为 Residual Block 可以直接插入模型中;<br>
还提出了矩阵运算的加速方法:</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi mathvariant="normal">z</mi><mi>i</mi></msub><mo>=</mo><msub><mi>W</mi><mi>z</mi></msub><mo>⋅</mo><msub><mi mathvariant="normal">y</mi><mi>i</mi></msub><mo>+</mo><msub><mi mathvariant="normal">x</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\mathrm{z}_i=W_z\cdot\mathrm{y}_i+\mathrm{x}_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathrm">z</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathrm" style="margin-right:0.01389em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0139em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathrm">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<p align="center">
  <img src="imgs/NonLocal_3.png" width="80%"><br>
  Optimization, <i>oc</i> is output channels.
</p>
<h3 class="crossnote-header" id="54-second-order-attention-network-for-single-image-super-resolution-san-2019">5.4. Second-order Attention Network for Single Image Super-Resolution (SAN, 2019)</h3>

<p align="center">
  <img src="imgs/SAN_1.png" width="80%"><br>
</p>
<ul>
<li>用 SOCA 代替 Channel Attention</li>
<li>传统 Non-Local 计算量太大, 提出 Region-Level Non-Local</li>
</ul>
<p>与 CA 求平均数不同, SOCA 计算了协方差矩阵 (与 EigenFace 类似) 去提取特征间的独立性.</p>
<div class="center">
<table>
<thead>
<tr>
<th style="text-align:center">Implementation</th>
<th style="text-align:center">Framework</th>
<th style="text-align:center">Understandable</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><a href="https://github.com/daitao/SAN/blob/master/TrainCode/model/san.py#L347">SAN</a></td>
<td style="text-align:center">Pytorch</td>
<td style="text-align:center">❎</td>
</tr>
</tbody>
</table>
</div>
<h3 class="crossnote-header" id="55-single-image-super-resolution-via-a-holistic-attention-network-han-2020">5.5 Single Image Super-Resolution via a Holistic Attention Network (HAN, 2020)</h3>

<p align="center">
  <img src="imgs/HAN_1.png" width="80%"><br>
  HAN
  <img src="imgs/HAN_2.png" width="80%"><br>
  Layer Attention Module
  <img src="imgs/HAN_3.png" width="80%"><br>
  Channel-Spatial Attention Module
</p>
<ul>
<li>Channel Attention 只提取了同一层的特征, 忽略了不同层之间的特征</li>
<li>因此提出 Layer attention module (LAM) 和  channel-spatial attention module (CSAM) 同时提取相同层, 不同通道, 和不同位置的特征</li>
</ul>
<h3 class="crossnote-header" id="55-attention-vs-dense">5.5. Attention vs. Dense</h3>

<p align="center">
  <img src="imgs/HAN_4.png" width="80%"><br>
  Quantitative results with BI degradation model.
</p>
<h2 class="crossnote-header" id="6-%E5%9F%BA%E4%BA%8E-transformer-%E7%9A%84-sr-%E6%A8%A1%E5%9E%8B">6. 基于 Transformer 的 SR 模型</h2>

<h3 class="crossnote-header" id="61-%E4%BB%80%E4%B9%88%E6%98%AF-transformer">6.1. 什么是 Transformer</h3>

<ul>
<li>发现当时主流的 NLP 模型都是复杂递归 / 卷积网络 + Attention 机制</li>
<li>因此做减法, 只用 Attention 机制</li>
</ul>
<p align="center">
  <img src="imgs/Transformer_2.png" width="60%"><br>
  <img src="imgs/Transformer_1.png" width="80%"><br>
</p>
<ol>
<li>Self-Attention 直接得到输入序列间的 Attention 值, 不需要递归求解</li>
<li>Multi-Head Self-Attention 提取多维特征</li>
<li>缺少位置信息, 用 Positional Encoding 处理</li>
<li>Mask
<ul>
<li>Padding Mask: 解决输入长度不一致</li>
<li>Sequence Mask: 计算 Self-Attetion 时遮挡未来数据, 保留当前时刻 t 之前的数据</li>
</ul>
</li>
</ol>
<div class="center">
<table>
<thead>
<tr>
<th style="text-align:center">Implementation</th>
<th style="text-align:center">Framework</th>
<th style="text-align:center">Understandable</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><a href="https://github.com/jadore801120/attention-is-all-you-need-pytorch/tree/master/transformer">attention-is-all-you-need-pytorch</a></td>
<td style="text-align:center">Pytorch</td>
<td style="text-align:center">✅</td>
</tr>
</tbody>
</table>
</div>
<h3 class="crossnote-header" id="62-vit-%E7%AE%80%E4%BB%8B">6.2. ViT 简介</h3>

<p align="center">
  <img src="imgs/ViT_1.png" width="80%"><br>
</p>
<ul>
<li>Transformer 在 NLP 有很好的应用; 在视觉领域, Attenttion 机制多被用于卷积操作的一部分</li>
<li>提出使用纯粹的 Transformer 机制进行图像识别, 模型简单效果好, 扩展性强</li>
</ul>
<p><strong>CNN 的归纳偏置 (Inductive Bias)</strong></p>
<ol>
<li>局部性 (Locality / Two-Dimensional Neighborhood Structure), 即图片上相邻区域有相似特征</li>
<li>平移不变性 (Translation Equivariance),<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>g</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>=</mo><mi>g</mi><mo stretchy="false">(</mo><mi>f</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(g(x))=g(f(x))</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">))</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">))</span></span></span></span>, 其中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi></mrow><annotation encoding="application/x-tex">f</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.10764em;">f</span></span></span></span> 表示平移操作, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi></mrow><annotation encoding="application/x-tex">g</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span></span></span></span> 表示平移操作</li>
</ol>
<p>由于 CNN 具有以上两种归纳偏置, 训练前就有了很多先验信息, 因此需要较少数据就可以学习到一个比较好的模型.</p>
<p><strong>因此, 当训练数据集不够大的时候, ViT 的表现通常比同等大小的 ResNets 要差一些.</strong></p>
<p>作者发现 <strong>不管使用哪种位置编码方式, 模型的精度都很接近</strong>, 甚至不适用位置编码, 模型的性能损失也没有特别大.</p>
<div class="center">
<table>
<thead>
<tr>
<th style="text-align:center">Implementation</th>
<th style="text-align:center">Framework</th>
<th style="text-align:center">Understandable</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><a href="https://github.com/lucidrains/vit-pytorch/blob/main/vit_pytorch/vit_1d.py">vit-pytorch</a></td>
<td style="text-align:center">Pytorch</td>
<td style="text-align:center">✅</td>
</tr>
</tbody>
</table>
</div>
<h3 class="crossnote-header" id="63-swin-transformer-%E7%AE%80%E4%BB%8B">6.3. Swin Transformer 简介</h3>

<p align="center">
  <img src="imgs/SwinTransformer_1.png" width="60%"><br>
  <img src="imgs/SwinTransformer_2.png" width="80%"><br>
  <img src="imgs/SwinTransformer_3.png" width="80%">
</p>
<ul>
<li>问题 1: 图像中的对象 Scale 变化尺度会很大, 相同大小的 Patch 难以准确捕捉信息</li>
<li>问题 2: Transformer 计算复杂度太高</li>
<li>解决 1: 通过与 CNN 类似的分层结构处理图片, 使模型能灵活处理不同尺度的对象</li>
<li>解决 2: 采用 Window Self-Attention, 降低复杂度</li>
</ul>
<ol>
<li>相对位置编码</li>
<li>Cyclic Shift =&gt; 跨窗口特征提取</li>
<li>子窗口编码 + Mask =&gt; 计算 Self-Attention</li>
</ol>
<div class="center">
<table>
<thead>
<tr>
<th style="text-align:center">Implementation</th>
<th style="text-align:center">Framework</th>
<th style="text-align:center">Understandable</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><a href="https://github.com/microsoft/Swin-Transformer/blob/main/models/swin_transformer.py">Swing-Transformer</a></td>
<td style="text-align:center">Pytorch</td>
<td style="text-align:center">❎</td>
</tr>
</tbody>
</table>
</div>
<h3 class="crossnote-header" id="64-pre-trained-image-processing-transformer-ipt-2020">6.4. Pre-Trained Image Processing Transformer (IPT, 2020)</h3>

<p align="center">
  <img src="imgs/IPT_1.png" width="80%"><br>
  <img src="imgs/IPT_2.png" width="80%">
</p>
<ul>
<li>ViT</li>
<li>看到了 Transformer 在 NLP 的表现力, 应用于 CV 基础问题: 去噪, 超分辨和去雨</li>
<li>参数多, 比较难训练</li>
</ul>
<div class="center">
<table>
<thead>
<tr>
<th style="text-align:center">Implementation</th>
<th style="text-align:center">Framework</th>
<th style="text-align:center">Understandable</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center"><a href="https://github.com/huawei-noah/Pretrained-IPT/blob/main/model/ipt.py">Pretrained-IPT</a></td>
<td style="text-align:center">Pytorch</td>
<td style="text-align:center">✅</td>
</tr>
</tbody>
</table>
</div>
<h3 class="crossnote-header" id="65-swinir-image-restoration-using-swin-transformer-swinir-2021">6.5. SwinIR: Image Restoration Using Swin Transformer (SwinIR, 2021)</h3>

<p align="center">
  <img src="imgs/SwinIR_1.png" width="80%"><br>
</p>
<ul>
<li>Swin Transformer + ResNet</li>
</ul>
<h3 class="crossnote-header" id="66-image-super-resolution-with-non-local-sparse-attention-nlsa-2021">6.6 Image super-resolution with non-local sparse attention (NLSA, 2021)</h3>

<p align="center">
  <img src="imgs/NLSA_1.png" width="80%"><br>
</p>
<p>图像超分是一个被研究多年的任务, 作为一个非适定性 (ill-posed) 问题, 往往需要 <strong>加入许多图像先验作为正则化</strong>, 例如最具有代表性的<strong>稀疏, 非局部先验</strong></p>
<p>稀疏性约束在单张图超分 SISR (Singel Image Super-Resolution) 上已被很好地探索, 利用 <strong>稀疏编码 (sparse coding)</strong>, 图像 (图块) 可视作预先定义好的过完备字典, 小波 (wavelet), 曲波 (curvelet) 的稀疏线性组合.<br>
<strong>深度学习方法例如 SRCNN 也首先使用卷积实现了稀疏编码 (50%的特征被 ReLU 置为 0).</strong></p>
<p>此外, 非局部的图像先验 (Non-Local, NL) 也被很好地探索. NL 通过 <strong>全局搜索相关联的特征进行叠加</strong> 来增强图像表征. 不过应用在SISR上时会出现两个问题：</p>
<ol>
<li>在网络深层, 特征的感受野很大甚至是全局性的, 会导致 NL 计算的互相关性不准确.</li>
<li>NL 需要计算每个点之间的互相关性, 此计算量与图像大小成平方正相关, 为了解决这个问题, 一般会计算局部的相关性, 但这样做又会失去全局的特征。</li>
</ol>
<p>对此, 本文为 SISR 任务提出一种稀疏的全局注意力模块, 以此大大降低 NL 的计算量, 并将其嵌入例如 EDSR 这样的网络来形成 Non-Local Sparse Network (NLSN).</p>
<ul>
<li>哈希桶 + 超球, 两个向量的角度小更有可能落入同一个哈希桶中</li>
</ul>
<h2 class="crossnote-header" id="7-%E5%9F%BA%E4%BA%8E-pre-trained-%E5%92%8C-transformer-%E7%9A%84-sr-%E6%A8%A1%E5%9E%8B">7. 基于 Pre-Trained 和 Transformer 的 SR 模型</h2>

<h3 class="crossnote-header" id="71-on-efficient-transformer-based-image-pre-training-for-low-level-vision-edt-2022">7.1. On Efficient Transformer-Based Image Pre-training for Low-Level Vision (EDT, 2022)</h3>

<p align="center">
  <img src="imgs/EDT_1.png" width="80%"><br>
</p>
<ul>
<li>预训练在不同 low-level 任务中起不同的作用</li>
<li>通过探索了不同的预训练方法并证实: 多任务预训练更有效且数据高效</li>
</ul>
<h2 class="crossnote-header" id="8-%E6%80%BB%E7%BB%93">8. 总结</h2>

<p>Ref: <a href="https://zhuanlan.zhihu.com/p/558561628">桃川京夏</a></p>
<p>在 2019 年的综述 <em>Deep Learning for Image Super-resolution: A Survey</em> 中, 将图像超分辨率的结构分为以下四种：</p>
<ol>
<li>前端上采样 Pre-upsampling SR</li>
<li>后端上采样 Post-upsampling SR</li>
<li>渐进式上采样 Progressive upsampling SR</li>
<li>升降采样迭代 Iterative up-and-down Sampling SR.</li>
</ol>
<p align="center">
  <img src="imgs/00.png" width="60%"><br>
</p>
<p>在发展过程中, 后端上采样的结构具有引入噪声少, 速度快的优点, 逐渐成为主流.</p>
<p>目前, 图像超分辨率这一领域已趋于成熟, 不再区分上述四种形式, 基本已经统一为先修复, 再放大的结构, 即后端上采样.</p>
<p>模型基本都遵循相同的定式：浅层特征提取 (head) + 深层特征提取 (body) + 重建模块 (tail).</p>
<p>随着分类模型的推进, 图像超分辨率的改进目前大多都是在以上定式之下, 改进网络的body (CNN / Transformer / MLP).</p>

      </div>
      
      
    
    
    
    
    
    
  
    </body></html>